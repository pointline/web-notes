(window.webpackJsonp=window.webpackJsonp||[]).push([[111],{388:function(s,a,t){"use strict";t.r(a);var e=t(17),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"数值精度丢失"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数值精度丢失"}},[s._v("#")]),s._v(" 数值精度丢失")]),s._v(" "),t("p",[s._v("JavaScript内部所有的数字都是以"),t("code",[s._v("64位浮点数形式存储")]),s._v("，即使整数也是如此。因为数字(Number)采用"),t("code",[s._v("IEEE 754")]),s._v("规范64位双精度浮点数编码。于是会看到下面的情况")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// true")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// false")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2.9999999999999996")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("看到上面有些疑惑，于是搜罗一圈，总结一些理解过程")]),s._v(" "),t("blockquote",[t("p",[s._v("PS: 只要不是以5结尾的小数都会出现")])]),s._v(" "),t("h2",{attrs:{id:"前置知识点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前置知识点"}},[s._v("#")]),s._v(" 前置知识点")]),s._v(" "),t("h3",{attrs:{id:"十进制如何转换为二进制？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#十进制如何转换为二进制？"}},[s._v("#")]),s._v(" 十进制如何转换为二进制？")]),s._v(" "),t("p",[s._v("比如"),t("code",[s._v("5.25")]),s._v("转为二进制")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("整数部分除2取余，得到的商再除2，直到商为0，将余数倒序排列出来，得到就是二进制")])]),s._v(" "),t("li",[t("code",[s._v("小数部分乘2，取结果的整数部分（不是1就是0），然后再用小数部分再乘2，直到小数部分为0，将取整的整数部分顺序排列出来，得到二进制。再合并整数部分和小数部分得到的二进制就是完整的二进制数")])])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 5.25 十进制转为二进制")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 整数部分 5")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 取 1   |")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 取 0   |  倒序读取")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 取 1   |")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 二进制结果：101")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 小数部分 0.25")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.25")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 取 0   |")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.00")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 取 1   |  顺序读取")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 二进制结果：01")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 可以得出5.25的二进制表示：101.01")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h3",{attrs:{id:"二进制如何转换为十进制？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二进制如何转换为十进制？"}},[s._v("#")]),s._v(" 二进制如何转换为十进制？")]),s._v(" "),t("p",[s._v("二进制转为十进制不区分整数部分与小数部分。")]),s._v(" "),t("p",[s._v("需要说明，下面2的几次方那个次数是怎么确定的，比如从点往左数。")]),s._v(" "),t("p",[s._v("将二进制中的位数分别将下边对应的值相乘，然后相加得到的就是十进制")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 101.01 转为十进制")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n————————————————————————————\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.25")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.25")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.25")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("blockquote",[t("p",[s._v("PS:")]),s._v(" "),t("p",[t("code",[s._v("2^0")]),s._v(" 任何除0以外的数的0次方都是1。如3的0次方是1，-1的0次方也是1，0的0次方没有意义")]),s._v(" "),t("p",[t("code",[s._v("2^-1")]),s._v(" 2的-1次方就是1/2^1，"),t("code",[s._v("2^-2")]),s._v(" 2的-2次方就是1/2^2")])]),s._v(" "),t("h2",{attrs:{id:"javascript是如何保存数字的？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#javascript是如何保存数字的？"}},[s._v("#")]),s._v(" JavaScript是如何保存数字的？")]),s._v(" "),t("p",[s._v("JavaScript 数字(Number)采用"),t("code",[s._v("IEEE 754")]),s._v("规范64位双精度浮点数")]),s._v(" "),t("p",[t("img",{attrs:{src:"/assets/%E6%95%B0%E5%80%BC%E7%B2%BE%E5%BA%A6.jpg",alt:"数值精度"}})]),s._v(" "),t("ul",[t("li",[s._v("sign bit(符号位): 用来表示正负号，1位（0表示整数，1表示负数）")]),s._v(" "),t("li",[s._v("exponent(指数): 决定数值的大小，11位（2~12位）")]),s._v(" "),t("li",[s._v("mantissa(尾数)：用来表示精度，52位（超出部分自动进1舍零）")])]),s._v(" "),t("p",[s._v("下面来看看"),t("code",[s._v("5.25")]),s._v("十进制如何在JS中保存的")]),s._v(" "),t("ul",[t("li",[s._v("十进制"),t("code",[s._v("5.25")]),s._v("转为二进制"),t("code",[s._v("101.01")])]),s._v(" "),t("li",[s._v("二进制"),t("code",[s._v("101.01")]),s._v("可用二进制的科学计数法"),t("code",[s._v("1.10101 * 2^3")])]),s._v(" "),t("li",[t("code",[s._v("1.10101 * 2^3")]),s._v("的小数部分"),t("code",[s._v("10101")]),s._v("（二进制）就是mantissa（尾数）了，"),t("code",[s._v("3")]),s._v("（十进制）加上"),t("code",[s._v("1023")]),s._v("就是exponent（指数）了")]),s._v(" "),t("li",[s._v("接下来指数"),t("code",[s._v("3")]),s._v("要加上"),t("code",[s._v("1023")]),s._v("后转为二进制"),t("code",[s._v("10000000010")])]),s._v(" "),t("li",[t("code",[s._v("5.25")]),s._v("十进制数是一个正数，所以符号位二进制表示"),t("code",[s._v("0")])]),s._v(" "),t("li",[s._v("最后把符号位、指数、尾数。三部分拼接到一起，二进制"),t("code",[s._v("0-10000000010-1010100000000000000000000000000000000000000000000000")])]),s._v(" "),t("li",[s._v("为了方便查看符号位、指数、尾数以"),t("code",[s._v("-")]),s._v("分割，其中尾数"),t("code",[s._v("0101")]),s._v("不足，用"),t("code",[s._v("0")]),s._v("补足"),t("code",[s._v("52")]),s._v("位")])]),s._v(" "),t("blockquote",[t("p",[s._v("PS:")]),s._v(" "),t("p",[s._v("步骤2得出的科学计数中的整数部分1我们好像忘记，这里因为Javascript为了更最大限度的提高精确度，而省略了这个1，这样在我们我们本来只能保存（二进制）52位的尾数，实际是有（二进制）53位的")]),s._v(" "),t("p",[s._v("指数部分是11位，表示的范围是[0, 2047]，由于科学计数中的指数可正可负，所以，"),t("code",[s._v("中间数为 1023，[0,1022] 表示为负，[1024,2047] 表示为正")]),s._v("， 这也解释了为什么我们科学计数中的指数要加上1023进行存储了")])]),s._v(" "),t("h2",{attrs:{id:"javascript是如何读取数字的？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#javascript是如何读取数字的？"}},[s._v("#")]),s._v(" JavaScript是如何读取数字的？")]),s._v(" "),t("p",[s._v("从5.25的二进制"),t("code",[s._v("0-10000000010-1010100000000000000000000000000000000000000000000000")]),s._v("读取")]),s._v(" "),t("ul",[t("li",[s._v("首先获取指数部分二进制"),t("code",[s._v("10000000010")]),s._v("，转为十进制"),t("code",[s._v("1026")]),s._v("，"),t("code",[s._v("1026")]),s._v("减去"),t("code",[s._v("1023")]),s._v("就是实际的指数"),t("code",[s._v("3")])]),s._v(" "),t("li",[s._v("获取尾数部分"),t("code",[s._v("0-10000000010-1010100000000000000000000000000000000000000000000000")]),s._v("实际就是"),t("code",[s._v("0.10101")]),s._v("（后面的0就不写了），然后加上我们忽略的1，得出"),t("code",[s._v("1.10101")])]),s._v(" "),t("li",[s._v("因为首位位"),t("code",[s._v("0")]),s._v("，所以为正数，得出科学计数法"),t("code",[s._v("1.10101 * 2^3")]),s._v("，得出二进制"),t("code",[s._v("101.01")]),s._v("，再按照上面的二进制转十进制得出"),t("code",[s._v("5.25")])])]),s._v(" "),t("h2",{attrs:{id:"回到-0-1-0-2-0-3-看精度问题？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#回到-0-1-0-2-0-3-看精度问题？"}},[s._v("#")]),s._v(" 回到 "),t("code",[s._v("0.1 + 0.2 != 0.3")]),s._v(" 看精度问题？")]),s._v(" "),t("p",[s._v("看懂前面的原理，这部分就变得好理解了")]),s._v(" "),t("p",[s._v("首先要计算"),t("code",[s._v("0.1 + 0.2")])]),s._v(" "),t("ul",[t("li",[s._v("0.1 转为64位二进制\n"),t("ul",[t("li",[s._v("先将0.1转化为二进制的整数部分为0，小数部分为"),t("code",[s._v("0001100110011001100110011001100110011...")]),s._v("咦，这里居然进入了无限循环，那怎么办呢？暂时先不管")]),s._v(" "),t("li",[s._v("无限循环的二进制数用科学计数表示为"),t("code",[s._v("1.100110011001100110011001100110011... * 2^-4")])]),s._v(" "),t("li",[s._v("指数位即是"),t("code",[s._v("-4 + 1023 = 1019")]),s._v("，转化位11位二进制数"),t("code",[s._v("01111111011")])]),s._v(" "),t("li",[s._v("尾数位是无限循环的，但是双精度浮点数规定尾数位52位，于是超出52位的将被略去，保留"),t("code",[s._v("1001100110011001100110011001100110011001100110011010")])]),s._v(" "),t("li",[s._v("最后得出0.1的64位二进制浮点数："),t("code",[s._v("0-01111111011-1001100110011001100110011001100110011001100110011010")])])])]),s._v(" "),t("li",[s._v("0.2 转为64位二进制\n"),t("ul",[t("li",[t("code",[s._v("0-01111111100-1001100110011001100110011001100110011001100110011010")])])])]),s._v(" "),t("li",[s._v("将0.1的二进制相加\n"),t("ul",[t("li",[s._v("0.1二进制"),t("code",[s._v("0-01111111011-1001100110011001100110011001100110011001100110011010")])]),s._v(" "),t("li",[s._v("0.2二进制"),t("code",[s._v("0-01111111100-1001100110011001100110011001100110011001100110011010")])])])])]),s._v(" "),t("blockquote",[t("p",[s._v("PS:\n二进制加法运算：1 + 0 = 0, 0 + 0 = 0, 1 + 1 = 10，相当于进一位")])]),s._v(" "),t("p",[s._v("最后得出"),t("code",[s._v("0.0100110011001100110011001100110011001100110011001100111")]),s._v("转化为十进制数即为"),t("code",[s._v("0.30000000000000004")])]),s._v(" "),t("p",[s._v("精度缺失是在存储这一步就丢失了，后面的计算只是在不精准的值上进行的运算，所以就出现了误差")]),s._v(" "),t("h2",{attrs:{id:"解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[s._v("#")]),s._v(" 解决方案")]),s._v(" "),t("p",[s._v("对于整数，前端出现问题的几率可能比较低，毕竟很少有业务需要需要用到超大整数，只要运算结果不超过 Math.pow(2, 53) 就不会丢失精度")]),s._v(" "),t("p",[s._v("对于小数，前端出现问题的几率还是很多的，尤其在一些电商网站涉及到金额等数据。解决方式：把小数放到位整数（乘倍数），再缩小回原来倍数（除倍数）")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 0.1 + 0.2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// true")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);